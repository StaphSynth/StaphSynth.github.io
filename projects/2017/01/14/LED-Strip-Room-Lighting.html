<!DOCTYPE html> <html> <head> <meta charset="utf-8"/> <meta name="viewport" content="width=device-width, initial-scale=1"/> <title> LED Strip Room Lighting | Syntheta.se </title> <script type="text/javascript" src="https://use.fontawesome.com/0523816ffe.js"></script> <link rel="alternate" type="application/rss+xml" title="Syntheta.se RSS" href="/feed.xml"/> <link type="text/css" rel="stylesheet" href="/assets/css/main.css"/> <link type="text/css" rel="stylesheet" href="/assets/css/syntax.css"/> <link rel="icon" type="image/png" href="/assets/images/favicon-32x32.png" sizes="32x32"/> <link rel="icon" type="image/png" href="/assets/images/favicon-16x16.png" sizes="16x16"/> <meta name="generator" content="Jekyll v4.3.1"/> <meta property="og:title" content="LED Strip Room Lighting"/> <meta name="author" content="David Allen"/> <meta property="og:locale" content="en_US"/> <meta name="description" content="In January of 2015, I built an LED lighting controller and power supply to run about 25 metres of 12V 5050 LED strip lighting. The strip forms a ring around our back rumpus/listening/hobby room. The lights are mounted high up the walls only a few centimetres down from the cornices on L-shaped pine moulding, with the LEDs facing the ceiling so as not to dazzle the eye. It’s meant to light the room with a soft warm-white glow around the perimeter to provide a mellow mood for hanging out listening to the stereo, or during parties, etc."/> <meta property="og:description" content="In January of 2015, I built an LED lighting controller and power supply to run about 25 metres of 12V 5050 LED strip lighting. The strip forms a ring around our back rumpus/listening/hobby room. The lights are mounted high up the walls only a few centimetres down from the cornices on L-shaped pine moulding, with the LEDs facing the ceiling so as not to dazzle the eye. It’s meant to light the room with a soft warm-white glow around the perimeter to provide a mellow mood for hanging out listening to the stereo, or during parties, etc."/> <link rel="canonical" href="https://syntheta.se/projects/2017/01/14/LED-Strip-Room-Lighting.html"/> <meta property="og:url" content="https://syntheta.se/projects/2017/01/14/LED-Strip-Room-Lighting.html"/> <meta property="og:site_name" content="Syntheta.se"/> <meta property="og:image" content="https://syntheta.se/assets/images/P126-lightbox6.jpg"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2017-01-14T00:00:00+00:00"/> <meta name="twitter:card" content="summary_large_image"/> <meta property="twitter:image" content="https://syntheta.se/assets/images/P126-lightbox6.jpg"/> <meta property="twitter:title" content="LED Strip Room Lighting"/> <script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"David Allen"},"dateModified":"2017-01-14T00:00:00+00:00","datePublished":"2017-01-14T00:00:00+00:00","description":"In January of 2015, I built an LED lighting controller and power supply to run about 25 metres of 12V 5050 LED strip lighting. The strip forms a ring around our back rumpus/listening/hobby room. The lights are mounted high up the walls only a few centimetres down from the cornices on L-shaped pine moulding, with the LEDs facing the ceiling so as not to dazzle the eye. It’s meant to light the room with a soft warm-white glow around the perimeter to provide a mellow mood for hanging out listening to the stereo, or during parties, etc.","headline":"LED Strip Room Lighting","image":"https://syntheta.se/assets/images/P126-lightbox6.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://syntheta.se/projects/2017/01/14/LED-Strip-Room-Lighting.html"},"url":"https://syntheta.se/projects/2017/01/14/LED-Strip-Room-Lighting.html"}</script> </head> <body> <div id="page-wrapper"> <header> <noscript> <div id="noscript"> JavaScript is turned off. Please <a href="https://enable-javascript.com/" target="_blank"> enable JavaScript </a> for full use of this site. </div> </noscript> <div id="masthead"> <div id="heading"> <a href="/"> <h1>Synthetase's World of Nerd</h1> </a> </div> </div> <nav id="main-menu"> <button id="nav-icon" type="button"> <i class="fa fa-bars"></i> <i class="fa fa-caret-down" aria-hidden="true"></i> </button> <ul> <li> <a href="/"> Home </a> </li> <li> <a href="/coding/"> Coding </a> </li> <li> <a href="/projects/" class="selected"> Projects </a> </li> <li> <a href="/about/"> About </a> </li> </ul> </nav> </header> <div id="content-wrapper"> <section id="article"> <div class="article-header"> <div class="title-section"> <div class="thumb-container"> <img src="/assets/images/logos/led.png" alt="" aria-hidden="true"/> </div> <div class="post-title"> <h2>LED Strip Room Lighting</h2> </div> </div> <ul class="post-data"> <li> <p> <i class="fa fa-calendar" aria-hidden="false"></i><noscript>Posted on</noscript> 14 January 2017&ensp;|&ensp; </p> </li> <li> <p> <i class="fa fa-edit" aria-hidden="false"></i><noscript>Last modified on</noscript> 16 January 2017&ensp;|&ensp; </p> </li> <li> <p> <i class="fa fa-tags" aria-hidden="false"></i><noscript>Tagged in</noscript> <a href="/tags/#electronics">electronics</a>, <a href="/tags/#lighting">lighting</a>, <a href="/tags/#power+supplies">power supplies</a>, <a href="/tags/#repairs">repairs</a>. </p> </li> </ul> </div> <p>In January of 2015, I built an LED lighting controller and power supply to run about 25 metres of 12V 5050 LED strip lighting. The strip forms a ring around our back rumpus/listening/hobby room. The lights are mounted high up the walls only a few centimetres down from the cornices on L-shaped pine moulding, with the LEDs facing the ceiling so as not to dazzle the eye. It’s meant to light the room with a soft warm-white glow around the perimeter to provide a mellow mood for hanging out listening to the stereo, or during parties, etc.</p> <h3 id="initial-build">Initial Build</h3> <p>The plan was fairly straight-forward: buy the LED strip lights, a beefy 12V supply to run them, and use an <a href="https://sound-au.com/">ESP</a> <a href="https://sound-au.com/project126.htm">P126 PWM dimmer</a> to allow control of the light level. Then, string them together and enjoy. Needless to say, the project became a little more complex as time went on, and I learned some valuable lessons along the way.</p> <p>The first mistake I made was to buy a crappy 360W 12V supply from ebay. These supplies do not have a very good reputation for longevity, and I opted to go with one that provided more power than I actually needed in the hopes that the added headroom would make it last a little longer.</p> <div class="article-figure-container"> <figure class="article-figure"> <img src="/assets/images/12v-crapsupply.jpg" alt="These cheap supplies are all over ebay like a rash. Theyr'e noisy and not of very high quality. I found out later on that they're also not very efficient."/> <figcaption> These cheap supplies are all over ebay like a rash. Theyr'e noisy and not of very high quality. I found out later on that they're also not very efficient. </figcaption> </figure> </div> <p>After the supply arrived, I pulled it apart to find several very good reasons why these supplies are not well regarded. Completely inadequate thermal management of the switching transistors and high-current rectifier diodes (bolted straight to the case, very poor thermal contact), low quality electrolytic capacitors, and a whiny 60mm fan completed the picture. This project being done on the cheap, however, I decided to press on and see if I could make it work regardless.</p> <p>I decided to attack the thermal problems first. I moved the main switching transistors from the rear of the board to the side and mounted them, along with the secondary side rectifier diodes, to half an 80mm tunnel-style heatsink. This heatsink is quite large and has a thermal resistance of ~0.8 °C/W without fan assistance.</p> <p>Given that this supply was to be mounted in the same room as the stereo, I wanted it to run without a fan unless absolutely necessary. A piece of PVC pipe was used to complete the tunnel on the other side of the sink and a quiet 80mm fan was mounted at the bottom end to blow air up through the heatsink tunnel assembly should the temerature rise too far.</p> <div class="article-figure-container"> <figure class="article-figure"> <img src="/assets/images/P126-lightbox1.jpg" alt="The box during construction. You can see the heatsink and the half-section of PVC pipe I used to complete the tunnel. I also decided to use 6.5mm mono phone sockets as output jacks because I had some lying around and couldn't think of anything better :)"/> <figcaption> The box during construction. You can see the heatsink and the half-section of PVC pipe I used to complete the tunnel. I also decided to use 6.5mm mono phone sockets as output jacks because I had some lying around and couldn't think of anything better :) </figcaption> </figure> </div> <p>The fan is controlled by a <a href="https://sound-au.com/project42.htm">P42</a> thermo-fan switching circuit I made quite some time before. The circuit works by sensing the voltage across a couple of ordinary silicon diodes. As the temperature of the P-N junction in a diode rises, the the voltage across it falls. A 741 opamp wired as a comparitor monitors this voltage and compares it with a fixed reference.</p> <p>Once it hits a certain level (which you set when you calibrate the circuit), the output of the opamp flips and goes low, turning on a PNP transistor that then switches on the fan. In this case, I used a glass of warm water to help me set the circuit to turn the fan on when the heatsink reaches ~45 °C. It almost never turns on except for hot days.</p> <div class="article-figure-container"> <figure class="article-figure"> <img src="/assets/images/P126-lightbox3.jpg" alt="ESP P42 thermo fan controller mounted to heatsink"/> <figcaption> Shot of the P42 fan controller mounted on the right. The sense diodes have not been installed yet. The transistor mounted to the heatsink is what switches the fan on. It doesn't need all that heatsinking, but it was available, so why not? </figcaption> </figure> </div> <p>The P126 PWM dimmer circuit connects the power supply to the lights and allows adjustment of the brightness of the LEDs via a single 10k potentiometer. The circuit uses a couple of dual opamps to provide the PWM function. Two are set up to form a triangle wave oscillator with a frequency of around 400Hz. A third is wired as a comparitor, and just like in P42, compares the voltage of the triangle wave with the reference voltage across the 10k pot.</p> <p>When the value of the triangle wave is lower than the reference, the output of the comparitor goes high and switches on a power MOSFET to allow current to flow in the lights and vice versa. By changing the value of the 10k pot, you change the reference voltage, which alters the duty cycle of the MOSFET and hence the average brightness. Check out the <a href="https://sound-au.com/project126.htm">project article</a> for a more detailed explanation as well as a circuit diagram.</p> <p>Unfortunately, the only MOSFETs I had to hand were a few IRF540s, with a current limit of 27-33A (depending on whose datasheet you’re reading). The number of LEDs to be powered would need over 20A at the brightest setting and would push a single device towards the edge of its safe operating area. To solve this, I decided to split the room light ring into two halves and use a separate MOSFET to power each half. One drives the back wall and one side, the other drives the front wall and the other side.</p> <p>This turned out to be a good idea because it halves the current through each MOSFET, doubles the thermal transfer area of the MOSFETs to the heatsink, halves the total current flowing through the main power cables to the LEDs (since there are now two pairs instead of one), and reduces the voltage losses across the cabling as well as cable width requirements. This lunch is not free, but for the small cost of an additional MOSFET, connector, and an extra 2m of cheap speaker cable, it comes heavily discounted :)</p> <div class="article-figure-container"> <figure class="article-figure"> <img src="/assets/images/P126-lightbox2.jpg" alt="ESP P126 mounted to heatsink using two MOSFETs rather than one."/> <figcaption> In this shot you can see the P126 PWM board mounted on the left of the heatsink, with its switching MOSFETs mounted off to one side with their daughter-board. </figcaption> </figure> </div> <p>The P126 PWM MOSFETs are mounted off the board directly on the heatsink, with a small daughter-board made of prototyping board used to provide a mounting point for the heavy power cables and gate resistors required to damp ringing of the control signal from P126.</p> <div class="article-figure-container"> <figure class="article-figure"> <img src="/assets/images/P126-lightbox4.jpg" alt="The finished box mounted to the wall near the room entrance. The switch is for power and the knob for brightness."/> <figcaption> The finished box mounted to the wall near the room entrance. The switch is for power and the knob for brightness. </figcaption> </figure> </div> <p>The unit is built into a wooden box made of pieces of pine and Tasmanian oak off-cuts. The inside is lined with earthed aluminium foil to help sink EMI. Connections to the outside world are via holes drilled in the wooden panels with a hole-saw. The connectors were then mounted onto a thinner piece of material (such as aluminium sheet) and then screwed to the panels behind the holes.</p> <div class="article-figure-container"> <figure class="article-figure"> <img src="/assets/images/P126-lightbox5.jpg" alt="Underside of the completed light controller, showing the power cord socket and lower ventillation holes produced using a hole saw."/> <figcaption> Underside of the completed light controller, showing the power cord socket and lower ventillation holes produced using a hole saw. </figcaption> </figure> </div> <p>The vent holes in the top and bottom of the case were covered in flywire to stop insects and inquisitive fingers from making their way into the box. It wasn’t strictly necessary because the heatsink blocks off the high-voltage side of the box from the vents, but it seemed like a good idea nonetheless.</p> <div class="article-figure-container"> <figure class="article-figure"> <img src="/assets/images/P126-lightbox6.jpg" alt="The light strip in action."/> <figcaption> The light strip in action. </figcaption> </figure> </div> <h3 id="repair">Repair</h3> <p>The project worked well over a year, but failed one night without much fanfare. The lights gave a flicker, the supply made a funny noise, and then it all went dark. I pulled it apart the next day to discover that the main filter capacitors on the primary side of the supply (“Rubycong” knock-offs of Rubycon) had failed. These caps were rated at 250V 680uF. One measured 420uF, the other 16.7nF. I decided to replace all the electrolytics in the supply with high quality ones - which is something I should have done when I first built it.</p> <p>The primary filter caps were replaced with legit Rubycon 250V 560uF, the closest value I could get with the same footprint. The output filter caps on the secondary were replaced with Panasonic high performance, low ESR caps specifically designed for high-current switching supply filtering. I also replaced all the small electrolytics in the control circuitry, although this probably wasn’t really necessary, so they just got cheaper Lelon low ESR parts.</p> <div class="article-figure-container"> <figure class="article-figure"> <img src="/assets/images/P126-lightbox7.jpg" alt="The light controller in its completed state with new capacitors. I used heavy gauge wire to carry the DC out of the unit and high-current diodes are soldered backwards across the sockets to catch any inductive spiking coming back from the power cables and stop it damaging the MOSFETs."/> <figcaption> The light controller in its completed state with new capacitors. I used heavy gauge wire to carry the DC out of the unit and high-current diodes are soldered backwards across the sockets to catch any inductive spiking coming back from the power cables and stop it damaging the MOSFETs. </figcaption> </figure> </div> <p>After putting it back together, the supply refused to start. I found this puzzling as there were no other obvious signs of damaged or failed parts. Thus the great trouble-shooting saga began. This was hampered by the fact that I couldn’t connect most of my test gear to the supply becuase most of it runs at mains potential and I don’t have any isolated probes for my oscilloscope. I wasn’t going to risk killing the ‘scope on a cheap supply, so I was stuck with a multi-meter and my brain.</p> <p>I probed around with the multi-meter set to DC volts and did some reverse-engineering on the primary side of the supply. It turns out that this supply is a very old <a href="https://sound-au.com/articles/smps-primer.html#s54">half-bridge</a> design. After a bit more reverse-engineering and probing, I discovered that the main control IC was not getting any power. I traced out its supply and found that it came from an auxillary sense winding on the main transformer. This suggested the transformer wasn’t doing anything. Lo and behold, one of the main switching transistors driving the primary coil measured ~300 ohms from collector to emitter, rather than the many mega-ohms it should have been.</p> <p>This was surprising for a couple of reasons: firstly, I expected to find MOSFETs as the primary switching transistors, not high-voltage NPN devices. Secondly, I would have thought that if a transistor was going to fail in this application, it would fail properly short circuit and read almost zero ohms from one side to the other, not this weird half-way value. Still, live and learn and all that :)</p> <div class="article-figure-container"> <figure class="article-figure"> <img src="/assets/images/P126-lightbox8.jpg" alt="Preparing the new power transistors for mounting to their heat-spreader. I used kapton film as an insulator (I threw away the crappy sil-pads that came with the supply when I first pulled it apart)."/> <figcaption> Preparing the new power transistors for mounting to their heat-spreader. I used kapton film as an insulator (I threw away the crappy sil-pads that came with the supply when I first pulled it apart). </figcaption> </figure> </div> <p>Anyway, I ordered a couple of new D209L transistors and replaced the old ones. This was a very fiddly job due to the nature of the lightbox and the way I originally built it. The transistors and diodes are attached to the main heatsink via heat-spreading aluminium plates salvaged from the original power supply chassis. The way these are mounted makes accessing them through the other components on the board very difficult.</p> <div class="article-figure-container"> <figure class="article-figure"> <img src="/assets/images/P126-lightbox9.jpg" alt="Getting the transistors mounted back into that tight space was a difficult and fiddly job. In this shot, you can also see one of the P42 temperature sensing diodes glued to the junction of heat-spreader and main sink."/> <figcaption> Getting the transistors mounted back into that tight space was a difficult and fiddly job. In this shot, you can also see one of the P42 temperature sensing diodes glued to the junction of heat-spreader and main sink. </figcaption> </figure> </div> <p>Still, after replacing these transistors, the supply is now working again. However, it is now making a mildly irritating whining noise. I believe this is due to magnetostriction. Although it used to make a little noise when I first built it, it’s now quite a bit louder, so I’ll have to figure out a way of damping it.</p> <h3 id="lessons-learned">Lessons Learned</h3> <p>Number one: never buy another one of those crappy ebay supplies. The designs are ancient, the construction is not good and the components are complete crap. You get what you pay for :) In my defence, at the time I bought it, I didn’t know anything about good supply manufacturers like PULS and the like. Next time, do more research!</p> <p>Number two: switchmode supply design. I learned quite a bit during my reverse-engineering of this supply and the background reading I did in support of it. That, in part, makes the saga worthwhile I guess.</p> <p>Number three: When (not if, but <em>when</em>) this supply fails again, I’ll probably just replace it with two good quality “lump-in-the-cord” power bricks, each powering half the lights. This seems like a much easier and less fiddly solution than re-engineering ebay junk.</p> <div id="disqus_thread"></div> <script type="text/javaScript">var disqus_config=function(){this.page.url="https://syntheta.se/projects/2017/01/14/LED-Strip-Room-Lighting.html",this.page.identifier="/projects/2017/01/14/LED-Strip-Room-Lighting"};!function(){var t=document,e=t.createElement("script");e.src="//synthetase.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}();</script> <noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow"> comments powered by Disqus. </a> </noscript> </section> </div> <footer> <div id=footer-container> <section id="connect"> <p>Connect with me:</p> <ul> <li> <a href="https://github.com/StaphSynth" target="_blank"> <i class="fa fa-github-square social" aria-hidden="false"></i> </a> </li> <li> <a href="https://www.linkedin.com/in/david-allen-102290119/" data-proofer-ignore target="_blank"> <i class="fa fa-linkedin-square social" aria-hidden="false"></i> </a> </li> <li> <a href="https://syntheta.se/feed.xml"> <i class="fa fa-rss-square social" aria-hidden="false"></i> </a> </li> </ul> </section> <section id="licence"> <ul> <li id="ccLogo"> <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"> <img src="https://syntheta.se/assets/images/cc.png" alt="Creative commons logo"/> </a> </li> <li>This site is licensed under a Creative Commons <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"> Attribution-ShareAlike </a> 4.0 International Licence. </li> </ul> </section> </div> </footer> </div> </body> <script type="text/javascript">!function(){function t(){["https://code.jquery.com/jquery-1.11.0.min.js","https://syntheta.se/assets/javascript/synth.js"].forEach(t=>{const e=document.createElement("script");e.src=t,e.type="text/javascript",e.async=!1,document.body.appendChild(e)})}window.addEventListener("load",t,!1)}();</script> </html>